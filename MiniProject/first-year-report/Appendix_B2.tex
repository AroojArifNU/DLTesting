\newpage
\subsection{RES generation function}
\label{resgen1}
Appendix B.2 contains the details for the implementation of MATLAB function named "res\_gen.m" which is called in main file. Please save this file in the same folder as main file. Step by step guidelines are provided in \textit{readme.txt} file.\par
\begin{linenumbers}
\begin{lstlisting}

\end{lstlisting}
\hypertarget{wt_code}{}
\hyperlink{wt_text}{Wind turbine code}
\begin{lstlisting}

function [re_wind_new rg_new_pv tem v current1 current2 current3 voltage1 voltage2 voltage3]= res_gen
A=75; %%% rotor swept area of wind turbine
cp=2.5;  %%% maximum power co-effiecent of wind`` turbine
v=[1 0.6 1 1.1 1.2 2.42 6.047 7.255 10.31 15.5 16 17.5 12.9 9.6 10.7 14 13.6 4.3 6.8 11.5 1.2 1.2 1.05 0.8]; %% wind spead for 24 hours
p=1.225; %% Air density
for hour=1:24 %%%
re_wind(hour)=1/2*cp*p*A*v(hour);
re_wind_new=re_wind/1000; %%% convertion of watts in to killowatts
end
sum_RES_wind=(sum(re_wind_new)); % total electricity generated by wind turbine in a day

%%%%%%%%%%%%%%%%%%%  end of Wind generation


%%%%%%%%%%%%%%%% parameters for RES %%%%%%%%%%%%%%%%%%
\end{lstlisting}
\hypertarget{pv_code}{}
\hyperlink{pv_text}{Solar panel integration code}
\begin{lstlisting}

tem=[18 18.5 19 20 21 22 24 25 25.5 26 27 28 29 30 29.8 29.5 29.2 29 28.5 27 25 23 21 18 ]; %temprature of a day for PV generation irr=[0 0 0 0 31 300 530 790 1005 1140 1230 1270 1200 1050 850 620 370 95 0 0 0 0 0 0]; %irrediation

A=0.90;   % Area of solar panel that are integrated
EF=0.95;   %%%% efficiency
for hourr=1:24 %%%
 rg(hourr)=EF*A*irr(hourr)*(1-0.005.*(tem(hourr)-25));
 rg_new(hourr)=0.9.*(EF*A*irr(hourr)*(1-0.005.*(tem(hourr)-25))); %% 10% loss during dc to ac convertion
 rg_new_pv(hourr)=rg_new(hourr)/1000; %% convets electricity watts in to killowatts
end
sum_RES_pv=(sum(rg_new)); % total of electricity generated by solar in a day
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

[current1 current2 current3 voltage1 voltage2 voltage3] =IV_curve();
end
\end{lstlisting}
\end{linenumbers} 